{"version":3,"file":"index.es.js","sources":["../src/index.ts"],"sourcesContent":["import type { MilkdownPlugin } from '@milkdown/ctx'\nimport type { Transaction } from '@milkdown/prose/state'\nimport { AllSelection, TextSelection } from '@milkdown/prose/state'\nimport { $ctx, $shortcut } from '@milkdown/utils'\n\n/// Add indent config.\nexport interface IndentConfigOptions {\n  /// The type of indent, `space` or `tab`. By default, it's `space`.\n  type: 'space' | 'tab'\n  /// The size of indent. By default, it's `2`.\n  size: number\n}\n\nfunction updateIndent(\n  tr: Transaction,\n  options: IndentConfigOptions\n): Transaction {\n  const { doc, selection } = tr\n\n  if (!doc || !selection) return tr\n\n  if (\n    !(selection instanceof TextSelection || selection instanceof AllSelection)\n  )\n    return tr\n\n  const { to } = selection\n\n  const text =\n    options.type === 'space' ? Array(options.size).fill(' ').join('') : '\\t'\n\n  return tr.insertText(text, to)\n}\n\n/// A slice contains the indent config.\n/// You can use [IndentConfigOptions](#IndentConfigOptions) to customize the behavior of the plugin.\n///\n/// ```ts\n/// import { indent, indentConfig } from '@milkdown/plugin-indent'\n///\n/// Editor\n///   .make()\n///   .config((ctx) => {\n///     ctx.set(indentConfig.key, {\n///       type: 'space',\n///       size: 4,\n///     })\n///   })\n/// ```\nexport const indentConfig = $ctx<IndentConfigOptions, 'indentConfig'>(\n  { type: 'space', size: 2 },\n  'indentConfig'\n)\n\nindentConfig.meta = {\n  package: '@milkdown/plugin-indent',\n  displayName: 'Ctx<indentConfig>',\n}\n\n/// Add indent shortcut, when users press `Tab`, the plugin will insert indent text.\nexport const indentPlugin = $shortcut((ctx) => ({\n  Tab: (state, dispatch) => {\n    const config = ctx.get(indentConfig.key)\n    const { tr } = state\n    const _tr = updateIndent(tr, config)\n\n    if (_tr.docChanged) {\n      dispatch?.(_tr)\n      return true\n    }\n\n    return false\n  },\n}))\n\nindentPlugin.meta = {\n  package: '@milkdown/plugin-indent',\n  displayName: 'Shortcut<indent>',\n}\n\n/// The plugin of indent.\nexport const indent: MilkdownPlugin[] = [indentConfig, indentPlugin]\n"],"names":["updateIndent","tr","options","doc","selection","TextSelection","AllSelection","to","text","indentConfig","$ctx","indentPlugin","$shortcut","ctx","state","dispatch","config","_tr","indent"],"mappings":";;AAaA,SAASA,EACPC,GACAC,GACa;AACP,QAAA,EAAE,KAAAC,GAAK,WAAAC,EAAA,IAAcH;AAKzB,MAHE,CAACE,KAAO,CAACC,KAGX,EAAEA,aAAqBC,KAAiBD,aAAqBE;AAEtD,WAAAL;AAEH,QAAA,EAAE,IAAAM,MAAOH,GAETI,IACJN,EAAQ,SAAS,UAAU,MAAMA,EAAQ,IAAI,EAAE,KAAK,GAAG,EAAE,KAAK,EAAE,IAAI;AAE/D,SAAAD,EAAG,WAAWO,GAAMD,CAAE;AAC/B;AAiBO,MAAME,IAAeC;AAAA,EAC1B,EAAE,MAAM,SAAS,MAAM,EAAE;AAAA,EACzB;AACF;AAEAD,EAAa,OAAO;AAAA,EAClB,SAAS;AAAA,EACT,aAAa;AACf;AAGa,MAAAE,IAAeC,EAAU,CAACC,OAAS;AAAA,EAC9C,KAAK,CAACC,GAAOC,MAAa;AACxB,UAAMC,IAASH,EAAI,IAAIJ,EAAa,GAAG,GACjC,EAAE,IAAAR,MAAOa,GACTG,IAAMjB,EAAaC,GAAIe,CAAM;AAEnC,WAAIC,EAAI,cACNF,KAAA,QAAAA,EAAWE,IACJ,MAGF;AAAA,EAAA;AAEX,EAAE;AAEFN,EAAa,OAAO;AAAA,EAClB,SAAS;AAAA,EACT,aAAa;AACf;AAGa,MAAAO,IAA2B,CAACT,GAAcE,CAAY;"}